---
dependencies:
  - role: meta/repository
    repository_key: '0xb9316a7bc7917b12'
    repository_url: 'deb http://ppa.launchpad.net/chris-lea/redis-server/ubuntu trusty main'

  - role: package/upstart
    when: redis_server
    upstart_description: 'redis server'
    upstart_exec_path: /usr/bin/redis-server
    upstart_exec_flags:
      - /etc/redis/redis.conf
    upstart_group: "{{ redis_group }}"
    upstart_log_root: "{{ redis_log_root }}"
    upstart_name: redis-server
    upstart_pidfile_path: "{{ redis_server_pidfile_path }}"
    upstart_runtime_root: "{{ redis_runtime_root }}"
    upstart_user: "{{ redis_user }}"

  - role: meta/monitor
    when: redis_server
    monitor_name: redis-server
    monitor_pidfile: "{{ redis_server_pidfile_path }}"

# New logging method awaiting redis regex formatting
#   - role: package/fluentd
#     fluentd_sources:
#       - path: "{{ redis_server_log_path }}"
#         format: ''
#         tag: redis-server.service
